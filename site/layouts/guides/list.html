{{ define "main" }}
  <div class="main py-5">
    <div class="container-fluid docs w-100">
      <h1 class="display-3">{{ .Title }}</h1>
      <p class="lead-text">{{ .Params.description }}</p>

   

      <!-- Guides List -->
      <div class="guides__list">
        {{ range where .Site.RegularPages.ByLastmod.Reverse "Section" "guides" }}
          <div class="guide-card" data-tags="{{ with .Params.tag }}{{ delimit . ", " }}{{ end }}">
            <div>
              <div class="guide-info">
                <div class="guide-tag"> 
            
                  {{ with .Params.tag }}
                    {{ if (in (printf "%T" .) "string") }}
                      {{ $tags := split . "," }}
                      {{ range $tags }}
                        <a href="/tags/{{ . | urlize }}">{{ . }}</a>{{ if not (eq . (index $tags (sub (len $tags) 1))) }}, {{ end }}
                      {{ end }}
                    {{ else }}
                      {{ range . }}
                        <a href="/tags/{{ . | urlize }}">{{ . }}</a>{{ if not (eq . (index . (sub (len .) 1))) }}, {{ end }}
                      {{ end }}
                    {{ end }}
                  {{ end }}
                </div>
                <h2>
                  <a href="{{ .RelPermalink }}">
                    {{ if .Params.displayTitle }}
                      {{ .Params.displayTitle }}
                    {{ else }}
                      {{ .Title }}
                    {{ end }}
                  </a>
                </h2>
                <p>
                  {{ if .Params.displayDescription }}
                    {{ .Params.displayDescription }}
                  {{ else }}
                    {{ .Description }}
                  {{ end }}
                </p>
               
              </div>
              <div class="write-info">
                <img src="{{ .Params.avatar | relURL }}" alt="{{ .Params.author }}" width="24" height="24" />
                <span>{{ .Params.author }}</span>
                <a href="{{ .RelPermalink }}" class="cta-link">Read the guide</a>
              </div>
            </div>
          </div>
        {{ end }}
      </div>
    </div>
  </div>

  <ul>
    {{ range where .Site.RegularPages.ByLastmod.Reverse ".Param.tags" "intersect" (slice "API") }}
    <li>
      <span>{{ .Date.Format (.Site.Params.dateFormat | default "January 2, 2006" ) }}</span>
      <a href="{{ .URL }}">{{ .Title }}</a>
    </li>
    {{ end }}
  </ul>
  <!-- JavaScript for Filtering -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const tagButtons = document.querySelectorAll(".tag-btn");
      const guides = document.querySelectorAll(".guide-card");

      tagButtons.forEach(button => {
        button.addEventListener("click", function () {
          const tag = this.getAttribute("data-tag");

          // Toggle active state
          tagButtons.forEach(btn => btn.classList.remove("active"));
          this.classList.add("active");

          // Filter guides
          guides.forEach(guide => {
            const guideTags = guide.getAttribute("data-tags").split(", ");
            if (guideTags.includes(tag)) {
              guide.style.display = "block";
            } else {
              guide.style.display = "none";
            }
          });
        });
      });
    });
  </script>
{{ end }}